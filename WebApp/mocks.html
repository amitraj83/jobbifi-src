<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">
    <title>Mock Interviews</title>
    <link href='https://fonts.googleapis.com/css?family=Lato:400,700,400italic,700italic|Roboto+Condensed:400,700'
          rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="css/bootstrap.min.css">
    <link rel="stylesheet" href="template/css/bootstrap.css">
    <link rel="stylesheet" href="template/css/font-awesome.min.css">
    <link rel="stylesheet" href="template/css/flexslider.css">
    <link rel="stylesheet" href="template/css/style.css">
    <link rel="stylesheet" href="template/css/custom.css">
    <link rel="stylesheet" href="template/css/responsive.css">
    <!--[if IE 9]>
    <script src="template/js/media.match.min.js"></script>
    <![endif]-->

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
</head>
<body>

<div id="main-wrapper">
    <div id="page-content">
        <div class="container">
            <div class="row">

                <div class="col-sm-8 page-content">
                    <div class="white-container candidates-search">
                        <div class="row">
                            <div class="col-sm-4">
                                <h5 class="mt5 mb0">Search Mock Interview</h5>
                            </div>
                            <div class="col-sm-6">
                                <input id="searchKey" type="text" class="form-control" style="width:100%;"
                                       placeholder="Enter skills"/>
                            </div>

                            <div class="col-sm-2">
                                <button id="searchMockBtn" class="btn btn-primary" type="button">Search</button>
                            </div>
                        </div>

                    </div>
                    <div class="row">
                        <div id="searchMockResult" class="col-md-12"></div>
                    </div>
                </div>

                <div class="col-sm-4 page-sidebar">
                    <aside>
                        <div class="widget sidebar-widget white-container social-widget">
                            <h5 class="widget-title">Share Us</h5>

                            <div class="widget-content">
                                <div class="row row-p5">
                                    <div class="col-xs-6 col-md-3 share-box facebook">
                                        <div class="count">86</div>
                                        <a href="#">Facebook</a>
                                    </div>

                                    <div class="col-xs-6 col-md-3 share-box twitter">
                                        <div class="count">2.2k</div>
                                        <a href="#">Twitter</a>
                                    </div>

                                    <div class="col-xs-6 col-md-3 share-box google">
                                        <div class="count">324</div>
                                        <a href="#">Google +</a>
                                    </div>

                                    <div class="col-xs-6 col-md-3 share-box linkedin">
                                        <div class="count">1.5k</div>
                                        <a href="#">LinkedIn</a>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="widget sidebar-widget text-center">
                            <a href="#"><img alt="" src="img/content/sidebar-ad.png"></a>
                        </div>

                        <div class="white-container">
                            <div class="widget sidebar-widget">
                                <h5 class="widget-title">5 Tips To Pass Your Interview!</h5>

                                <div class="widget-content">
                                    <div class="fitvidsjs">
                                        <div class="fluid-width-video-wrapper" style="padding-top: 50%;">
                                            <iframe frameborder="0" allowfullscreen=""
                                                    src="//www.youtube.com/embed/A6XUVjK9W4o?rel=0&amp;controls=2&amp;showinfo=0"
                                                    id="fitvid544396"></iframe>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="widget sidebar-widget">
                                <h5 class="widget-title">The Poll</h5>

                                <div class="widget-content">
                                    <p>Are you satisfied with your current employer?</p>

                                    <div class="radio">
                                        <label>
                                            <input type="radio" checked="" value="" name="sidebarpoll">
                                            Definitely Yes
                                        </label>
                                    </div>

                                    <div class="radio">
                                        <label>
                                            <input type="radio" value="" name="sidebarpoll">
                                            Rather Yes
                                        </label>
                                    </div>

                                    <div class="radio">
                                        <label>
                                            <input type="radio" value="" name="sidebarpoll">
                                            I'm not sure
                                        </label>
                                    </div>

                                    <div class="radio">
                                        <label>
                                            <input type="radio" value="" name="sidebarpoll">
                                            Rather Not
                                        </label>
                                    </div>

                                    <div class="radio">
                                        <label>
                                            <input type="radio" value="" name="sidebarpoll">
                                            Not at all
                                        </label>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </aside>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Scripts -->
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="js/jquery-1.11.0.min.js"><\/script>')</script>
<script src="template/js/jquery.ba-outside-events.min.js"></script>
<script src="template/js/jquery.responsive-tabs.js"></script>
<script src="template/js/jquery.flexslider-min.js"></script>
<script src="template/js/jquery.fitvids.js"></script>
<script src="template/js/jquery-ui-1.10.4.custom.min.js"></script>
<script src="template/js/jquery.inview.min.js"></script>
<script src="template/js/script.js"></script>
<script type="text/javascript" src="js/jquery.cookie.js"></script>
<script type="text/javascript" src="js/bootstrap.min.js"></script>
<script type="text/javascript" src="js/map.js"></script>
<script type="text/javascript" src="js/dateformat.js"></script>
<script type="text/javascript" src="js/sha1.js"></script>
<script type="text/javascript" src="js/library.js"></script>
<script type="text/javascript" src="js/frontcommon.js"></script>
<script type="text/javascript" src='js/strophe.js'></script>
<script type="text/javascript" src="js/chat.js"></script>
<script type="text/javascript">
    var loc = document.location + "";
    var BASE_URL = loc.substring(0, loc.lastIndexOf("/")) + "/";
    $(document).ready(function () {
        $("#searchMockBtn").click(function () {
            var searchKey = $("#searchKey").val();
            if (searchKey == "") {
                alert("Please enter the search term");
                return;
            }
            searchMocks(searchKey, 1);
        });

        $("#searchKey").on("keypress", function (e) {
            if (e.which == 13) {
                var searchKey = $("#searchKey").val();
                if (searchKey == "") {
                    alert("Please enter the search term");
                    return;
                }
                searchMocks(searchKey, 1);
                return false;
            }
        });
    });

    var resultMap = new Map;
    var TotalRecords = 0;

    // Currently implemented the client side pagination with the
    // storing the result in order store the result as we don't have
    // the status field on interview store in the solr
    function searchMocks(searchKey, currentPage) {
        var start = ((currentPage - 1) * 10);
        $.ajax({
            type: "GET",
            url: BASE_URL + "interviewsearch.do",
            data: "searchkey=" + searchKey + "&start=" + start,
        }).done(function (msg) {
            var wholeJSON = jQuery.parseJSON(msg);
            var json = wholeJSON.JSON_DOC_LIST;
            var resultsFound = false;
            var memberHTML = "<table>";

            var allResultsView = "";
            for (var i = 0; i < Object.keys(json).length; i++) {
                var attachment = "";
                if (null != wholeJSON.iidFiles[json[i].id] && "" != wholeJSON.iidFiles[json[i].id]) {
                    attachment = '<p><small><b>Attachment:</b>&nbsp;<a href="' + BASE_URL + wholeJSON.iidFiles[json[i].id].url + '">' + wholeJSON.iidFiles[json[i].id].original_name + '</a></small> </p>';
                }

                var profilepic = "images/face.jpg";
                if ("" != wholeJSON.pics[json[i].interviewee]) {
                    profilepic = wholeJSON.pics[json[i].interviewee];
                }

                var d = new Date(json[i].dt);
                var skills = json[i].skills;
                var skillsHTML = "";
                for (var j = 0; j < skills.length; j++) {
                    skillsHTML += '<span class="label label-info">' + skills[j] + '</span>&nbsp;';
                }
                var description = json[i].description;
                var oneresult = '<div class="candidates-item">' +
                        '<div class="thumb"><img alt="" src="' + profilepic + '"></div>' +
                        '<h6 class="title"><a href="#">' + json[i].title + '</a></h6>' +
                        '<ul class="top-btns">' +
                        '<li><i class="fa fa-calendar"></i> ' + prettyDate(new Date(Number(json[i].dt))) + ' </li>' +
                        '</ul>' +
                        '<p class="skills"><b>Skills</b> ' + skillsHTML + '</p>' +
                        '<p class="description descLess">' + getDescriptionLess(description, 155) + ' <a class="read-more" href="#">plase take mock interview</a></p>' +
                        '<div class="content">' +
                        '<p>' + description + '</p>' +
                        '	<ul class="list-unstyled">' +
                        '		<li><strong>Status:</strong> ' + getInterviewStatusLiteral(wholeJSON.istatus[json[i].id]) + '</li>' +
                        '	</ul>' +
                        '<hr>' +
                        '<div class="clearfix">' +
                        '<a class="pull-right toggle" href="#">Read Less</a>' +
                        '</div>' +
                        '</div>' +
                        '</div>';

                allResultsView = allResultsView + oneresult;
                resultsFound = true;
            }

            if (resultsFound == true) {
                var totalRecords = wholeJSON.NUM_OF_RESULTS;
                var pagination = getPaginationHTMLForMock(totalRecords, currentPage, searchKey);
                allResultsView = allResultsView + pagination;
                $("#searchMockResult").html(allResultsView);
            } else {
                $("#searchMockResult").html("<div class='alert alert-info'>No Results Found.</div>");
            }

            $("#maincontainer").html(screen);
        });
    }


    function getPaginationHTMLForMock(totalRecords, currentPage, searchKey) {
        var PAGE_SIZE = 10;
        var totalPages = Math.ceil(totalRecords / PAGE_SIZE);
        var html = "";
        if (totalPages >= 1) {
            html += "<ul class='pagination pull-right'>"
            for (var i = 0; i < totalPages; i++) {
                if (currentPage == (i + 1)) {
                    html = html + "<li class='active'><a href='javascript:void(0)'>" + (i + 1) + "</a></li>";
                } else {
                    html = html + "<li class=''><a href='javascript:searchMocks(\"" + searchKey + "\"," + (i + 1) + ")'>" + (i + 1) + "</a></li>";
                }
            }
            html += "</ul>"
        }
        return html;
    }
</script>
</body>
</html>
